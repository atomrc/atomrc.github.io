<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width"><link rel="alternate" type="application/rss+xml" title="Thomas Belin's Blog" href="https://blog.atomrc.dev/feed.xml"><link rel="icon" href="/favicon.ico"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><title>You might not need this - Thomas Belin</title><meta name="description" content="`this`, the least understood concept of the JavaScript language. What if I told you that you might not need it?"><meta name="author" content="Thomas Belin"><link rel="canonical" href="https://blog.atomrc.dev/p/you-dont-need-this/"><meta property="og:title" content="You might not need this - Thomas Belin"><meta property="og:description" content="`this`, the least understood concept of the JavaScript language. What if I told you that you might not need it?"><meta property="og:url" content="https://blog.atomrc.dev/p/you-dont-need-this/"><meta property="og:image" content="https://www.gravatar.com/avatar/56f2389bd912f388cc79874ce65fc0dc"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@atomrc"><meta name="twitter:title" content="You might not need this - Thomas Belin"><meta name="twitter:description" content="`this`, the least understood concept of the JavaScript language. What if I told you that you might not need it?"><meta name="twitter:image" content="https://www.gravatar.com/avatar/56f2389bd912f388cc79874ce65fc0dc"><meta name="color-scheme" content="dark light"><style>body{--ff-sans:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI","Ubuntu","Roboto","Noto Sans","Droid Sans",sans-serif;--ff-mono:ui-monospace,"Cascadia Mono","Segoe UI Mono","Ubuntu Mono","Roboto Mono",Menlo,Monaco,Consolas,monospace;padding:0;margin:0;color:var(--font-color);background-color:var(--bg-color);font-family:var(--ff-sans);font-size:13pt}body,body.light-mode{--font-color:#333;--font-secondary-color:#555;--bg-color:#fff;--title-color:#e7005d;--link-color:#0e4db5;--bg-code-color:#f6f6f6;--secondary-color:#eee}body.dark-mode{--font-color:#ddd;--font-secondary-color:#aaa;--bg-color:#1c1c21;--title-color:var(--link-color);--link-color:rgb(88, 166, 255);--bg-code-color:#444;--secondary-color:#333}#dark-mode-toggle{border:none;background-color:transparent;position:fixed;top:1em;right:1em;z-index:1;height:24px;width:24px;overflow:hidden}#dark-mode-toggle svg{stroke:var(--font-color);fill:var(--font-color);transition:opacity .3s,fill .3s,stroke .3s;position:absolute;top:0;left:0}.dark-mode #dark-mode-toggle .moon,.light-mode #dark-mode-toggle .sun{opacity:0}a{text-decoration:none;color:var(--link-color)}ul{list-style:none;padding:0}.avatar{height:100px;width:100px;border-radius:50px}.title{color:var(--title-color)}.tag{font-size:10pt;color:var(--font-secondary-color);font-style:italic}#header{text-align:center;font-size:1.95em;padding:1em}#header .title{color:var(--font-color);font-weight:200}#footer{text-align:center;padding:2em}.love{color:red}#footer a{color:inherit;text-decoration:underline}.list-container{max-width:50%;margin:auto;text-align:center}@media screen and (max-width:1000px){.list-container{max-width:75%}}@media screen and (max-width:650px){.list-container{max-width:80%}}.list-container__title{text-align:center}.list-container__list li{display:flex;padding-bottom:.5em}.list-container__list time{text-align:right;min-width:90px}.list-container__headline{max-width:500px}.list-container__content{display:inline-block;text-align:left}</style><script async defer="defer" data-domain="atomrc.dev" src="https://plausible.io/js/plausible.js"></script></head><body><button id="dark-mode-toggle" aria-label="Toggle bewteen dark and light mode"><svg xmlns="http://www.w3.org/2000/svg" class="sun" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" stroke="#000" fill="none" height="24" width="24"><circle r="5" cy="12" cx="12"/><path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72 1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" class="moon"><path style="stroke-width:.0469517" d="M13.278 24.02c3.707 0 7.093-1.687 9.336-4.451a.564.564 0 0 0-.543-.909c-5.831 1.111-11.186-3.36-11.186-9.247a9.41 9.41 0 0 1 4.765-8.188.564.564 0 0 0-.176-1.044 12.12 12.12 0 0 0-2.196-.2C6.643-.02 1.258 5.356 1.258 12c0 6.635 5.376 12.02 12.02 12.02z"/></svg></button><script>(function (win, doc) {
  let isDarkMode =
    sessionStorage.getItem("darkmode") === undefined
      ? win.matchMedia("(prefers-color-scheme: dark)").matches
      : sessionStorage.getItem("darkmode") === "true";

  const toggleDarkMode = (setDarkMode) => {
    isDarkMode = setDarkMode ?? !isDarkMode;
    sessionStorage.setItem("darkmode", isDarkMode);
    if (isDarkMode) {
      document.body.classList.add("dark-mode");
      document.body.classList.remove("light-mode");
    } else {
      document.body.classList.remove("dark-mode");
      document.body.classList.add("light-mode");
    }
  };

  toggleDarkMode(isDarkMode);
  const darkModeToggle = doc.getElementById("dark-mode-toggle");

  darkModeToggle.addEventListener("click", () => toggleDarkMode());
})(window, document);</script><div id="header"><div><a href="/"><img class="avatar" src="https://www.gravatar.com/avatar/56f2389bd912f388cc79874ce65fc0dc?s=200" alt="Avatar"></a><br><a class="title" href="/"><span rel="author">Thomas Belin</span></a><br></div></div><section><link href="/css/article.css" rel="stylesheet" async defer="defer"><link href="/css/syntax.css" rel="stylesheet" async defer="defer"><style>article{max-width:800px;margin:auto;padding:0 1em;position:relative;line-height:1.5em}article h1{font-size:2em;font-weight:300;line-height:1.2em}article h2,article h3{position:relative;padding-bottom:.3em;font-weight:500;line-height:1.2em}article h2{font-size:2em;border-bottom:solid 1px var(--secondary-color);margin:1em 0 .5em}article h3{font-size:1.5em;margin:1em 1em}article ul{list-style-type:disc;padding:0 2em}article picture{border:solid 1px grey;display:block;max-width:100%;margin:auto}picture img,video{width:100%;height:auto}</style><article lang="en"><header><h1 class="title">You might not need this</h1><aside><time class="folded-paper" datetime="2017-05-30T00:00:00.000Z" pubdate itemprop="datePublished" content="2017-05-30T00:00:00.000Z">30 <span class="month">May</span> 2017</time><br><span class="tag">posts</span>&nbsp; <span class="tag">javascript</span>&nbsp; <span class="tag">this</span>&nbsp;</aside></header><div class="article-body"><p>Consider the following beauty:</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">compute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token comment">//</span><br><span class="token punctuation">}</span></code></pre><p>Under the assumption that <code>compute</code> is a <strong>pure function</strong> (a function which will always return the same value given the same arguments. But not only, see <a href="https://en.wikipedia.org/wiki/Pure_function">Pure Function on Wikipedia</a>), you can easily deduce an interesting thing from those 3 lines: <em><code>compute</code> will always return the same value</em>.<br><code>compute</code> is, basically, <strong>a constant</strong>.</p><p>In JavaScript, it is very easy to break the purity of a function thus breaking the deduction we made earlier about <code>compute</code> being a constant.</p><p>One way to break purity, would be to read some external variable:</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">compute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> ext<span class="token punctuation">.</span>val <span class="token comment">// ext is some object defined in a parent scope</span><br><span class="token punctuation">}</span></code></pre><p>... And that external variable could be <code>this</code>:</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">compute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>val<br><span class="token punctuation">}</span></code></pre><p>We now have a way to change the returned value of <code>compute</code> <strong>from outside the function</strong>.</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token punctuation">{</span><br>  <span class="token literal-property property">val</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span><br>  <span class="token literal-property property">compute</span><span class="token operator">:</span> compute<br><span class="token punctuation">}</span><br><br>a<span class="token punctuation">.</span><span class="token function">compute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 1</span><br>a<span class="token punctuation">.</span>val <span class="token operator">=</span> <span class="token number">2</span><br>a<span class="token punctuation">.</span><span class="token function">compute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 2 ... so long purity, you will be missed</span></code></pre><p>You might be thinking that, at least, with a method call the bound object is never too far from the call, making it explicit that the returned value depends on that object (<em>maybe?</em>)!<br>Most of the time, is it true. But it is easy to find a counter example:</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> ext <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">val</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><br><span class="token comment">// create a function bound to `ext`</span><br><span class="token keyword">const</span> <span class="token function-variable function">compute</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>ext<span class="token punctuation">)</span><br><br><span class="token function">compute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 1</span><br>ext<span class="token punctuation">.</span>val <span class="token operator">=</span> <span class="token number">2</span><br><span class="token function">compute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 2</span></code></pre><h2 id="the-misunderstood-this" tabindex="-1">The misunderstood <code>this</code></h2><p><code>this</code> is probably the most misunderstood concept of the JavaScript language.<br>People coming from classical Object Oriented Programming languages often mistaken <code>this</code> for an instance of the class the method is in.</p><p>A better definition of <code>this</code> in JavaScript would be:</p><blockquote><p><code>this</code> represents the object which <em>owns</em> the method being called</p></blockquote><p>And, due to the dynamic nature of JavaScript, function ownerships often change at runtime.</p><p>Functions are <a href="http://ryanchristiani.com/functions-as-first-class-citizens-in-javascript/">first class citizen in JavaScript</a>, which means you can treat them as any other object: passing them around to functions or returning them.</p><p>Due to the asynchronous nature of JavaScript, you actually pass functions around a lot.</p><pre class="language-javascript"><code class="language-javascript"><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"/resource"</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token comment">// &lt;- callback is a function</span></code></pre><p>When the functions passed around are actually methods, they lose the binding with their initial object:</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token punctuation">{</span><br>  <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"/resource"</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>callback<span class="token punctuation">)</span> <span class="token comment">// &lt;- `this` is undefined</span></code></pre><p>To fix this, you need to manually bind the method to its owning object:</p><pre class="language-javascript"><code class="language-javascript"><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"/resource"</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// &lt;- `this` is defined again</span></code></pre><p><code>this</code> is such a mess for newcomers that TypeScript's documentation has an <a href="https://github.com/Microsoft/TypeScript/wiki/%27this%27-in-TypeScript">article dedicated to it</a>.</p><h2 id="functions-are-about-logic%2C-this-is-about-state" tabindex="-1">Functions are about logic, <code>this</code> is about state</h2><p>So we can ask the question: What does <code>this</code> do for us?</p><p>Common response:</p><blockquote><p><code>this</code> allows us to write logic close to our models. After all, this is what OOP is about.</p></blockquote><p>The way I see it:</p><blockquote><p><code>this</code> allows us to write <strong>stateful functions</strong>. It's a way to embed some state into a function</p></blockquote><p>In my opinion, <strong>functions should be building blocks that take some arguments and return a result depending on those arguments, and only those arguments</strong>.<br>This is what functional programming is about (see <a href="https://www.cs.kent.ac.uk/people/staff/dat/miranda/whyfp90.pdf">Why Functional Programming Matters</a>), and this is where the front-end is heading (<a href="https://medium.com/javascript-scene/why-learn-functional-programming-in-javascript-composing-software-ea13afc7a257">Why Learn Functional Programming in JavaScript? (Composing Software)</a>, <a href="https://medium.com/javascript-scene/master-the-javascript-interview-what-is-functional-programming-7f218c68b3a0">Master the JavaScript Interview: What is Functional Programming?</a>, <a href="http://ramdajs.com/">Ramda</a>, <a href="https://lodash.com/">lodash</a>, <a href="https://github.com/reactjs/redux">Redux</a> ...)</p><h2 id="the-separation-of-logic-and-state" tabindex="-1">The separation of logic and state</h2><p>Getting rid of <code>this</code> is as easy as replacing every occurrences of <code>this</code> by a new parameter.</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">compute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// becomes</span><br><br><span class="token keyword">function</span> <span class="token function">compute</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> a<span class="token punctuation">.</span>val <span class="token operator">+</span> <span class="token number">1</span><br><span class="token punctuation">}</span></code></pre><p>The second version of <code>compute</code> has some nice benefits:</p><ul><li>it is <strong>pure</strong> (only depends on its inputs)*;</li><li>its signature explicitly tells that it depends on some input <code>a</code>.</li></ul><p>Of course, to remove <code>this</code> from your functions you will also have to change every function calls. Not the funniest part, I agree.</p><p>Getting rid of <code>this</code> might feel a little scary and you might think you will lose powerful features. One nice feature I can think of is &quot;method chaining&quot;.</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> transformed <span class="token operator">=</span> <span class="token string">"test"</span><br>  <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"t"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"e"</span><span class="token punctuation">,</span> <span class="token string">"j"</span><span class="token punctuation">)</span><br>  <span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>If you remove <code>this</code> from those methods they become simple functions, and you need to transform that piece of code to:</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> transformed <span class="token operator">=</span> <span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"e"</span><span class="token punctuation">,</span> <span class="token string">"j"</span><span class="token punctuation">,</span> <span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"t"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>Definitely not as sexy as method chaining, right? And that's where functional programming concepts come handy and <a href="http://ramdajs.com/">Ramda</a> (or <a href="https://lodash.com/">Lodash</a>) are very powerful allies.</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token constant">R</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"ramda"</span><span class="token punctuation">)</span><br><br><span class="token keyword">const</span> removeT  <span class="token operator">=</span> <span class="token constant">R</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"t"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><br><span class="token keyword">const</span> e2j      <span class="token operator">=</span> <span class="token constant">R</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"e"</span><span class="token punctuation">,</span> <span class="token string">"j"</span><span class="token punctuation">)</span><br><span class="token keyword">const</span> testToJS <span class="token operator">=</span> <span class="token constant">R</span><span class="token punctuation">.</span><span class="token function">compose</span><span class="token punctuation">(</span>toUpperCase<span class="token punctuation">,</span> e2j<span class="token punctuation">,</span> removeT<span class="token punctuation">)</span><br><span class="token comment">//    ^ testToJS is a completly new function created</span><br><span class="token comment">// from the composition of the removeT, e2j and toUpperCase functions</span><br><br><span class="token keyword">const</span> transformed <span class="token operator">=</span> <span class="token function">testToJS</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span></code></pre><p>Note how this last example has make very nice and clear separation between logic and data. Only the last line is dealing with data (read &quot;state&quot;) while all the other lines of code are here to describe logic. The separation of concerns is perfectly respected :)</p><p>* <em>not using <code>this</code> inside your functions doesn't imply that they are pure at all. You still need to avoid any side effect in order to achieve purity.</em></p><h2 id="conclusion" tabindex="-1">Conclusion</h2><p>Taking away <code>this</code> from your developer's life is a great opportunity for you to leverage the full power of functions and finally start diving into <strong>functional programming</strong>.</p><p>In the process, you will learn how to write very simple functions and compose them together to create fully functional user interfaces.</p><p>I personally don't like <code>this</code> and try to avoid it as much as I can.<br>But, don't get me wrong, <code>this</code> is not evil and most JavaScript developers know how to deal with it.<br>Sometime you don't really have the luxury of being able to choose to use it or not. If you use React, for example, any <a href="https://facebook.github.io/react/docs/state-and-lifecycle.html#adding-local-state-to-a-class"><strong>stateful</strong> component</a> you will write will have to use <code>this</code> (which make sense when you have in mind that <code>this</code> is about state).</p><p>That being said, removing <code>this</code> will allow you to:</p><ul><li>make your function signatures more explicit;</li><li>isolate your state and models from your logic;</li><li>avoid any unexpected behavior due to the misunderstanding of the <code>this</code> concept.</li></ul><p>Also, it's seems like a perfect excuse to finally learn to love functions and to dive into functional programming :)</p></div><br><em>You enjoyed this article? Consider <a target="_blank" rel="noopener noreferrer" href="https://twitter.com/intent/tweet?url=https://blog.atomrc.dev/p/you-dont-need-this/&text=You might not need this&via=atomrc">tweeting it</a> :)</em></article><script src="/js/posts.js" async></script><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "WebSite",
      "@id": "https://blog.atomrc.dev#website",
      "url": "https://blog.atomrc.dev",
      "name": "Thomas Belin",
      "description": "Freelance Front-End Architect in Paris. I leave code cleaner than I found it. Seriously into Functional and Reactive Programming.",
      "inLanguage": "en"
    },
    {
      "@type": "BlogPosting",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://blog.atomrc.dev/p/you-dont-need-this/"
      },
      "url": "https://blog.atomrc.dev/p/you-dont-need-this/",
      "isPartOf": {
        "@id": "https://blog.atomrc.dev#website"
      },
      "headline": "You might not need this",
      "description": "`this`, the least understood concept of the JavaScript language. What if I told you that you might not need it?",
      "image": "https://www.gravatar.com/avatar/56f2389bd912f388cc79874ce65fc0dc?s=300",
      "inLanguage": "en",
      "publisher": {
        "@type": "Organization",
        "name": "Thomas Belin",
        "url": "https://blog.atomrc.dev#organization",
        "logo": {
          "@type": "ImageObject",
          "url": "https://www.gravatar.com/avatar/56f2389bd912f388cc79874ce65fc0dc?s=300",
          "width": 300,
          "height": 300
        }
      },
      "author": {
        "@type": "Person",
        "name": "Thomas Belin"
      },
      "keywords": "posts,javascript,this",
      "datePublished": "2017-05-30T00:00:00.000Z"
    }
  ]
}</script></section><div id="footer">Made with <span class="love">♥</span>️ by <a href="https://twitter.com/atomrc" rel="noopener noreferrer">@atomrc</a></div></body></html>