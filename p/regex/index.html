<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width"><link rel="alternate" type="application/rss+xml" title="Thomas Belin's Blog" href="https://blog.atomrc.dev/feed.xml"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><title>Regex : tips and tricks - Thomas Belin</title><meta name="description" content="Petites astuces utiles avec les regex"><meta name="robots" content="index,follow"><meta name="author" content="Thomas Belin"><link rel="canonical" href="https://blog.atomrc.dev/p/regex/"><meta property="og:title" content="Regex : tips and tricks - Thomas Belin"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.atomrc.dev/p/regex/"><meta property="og:description" content="Petites astuces utiles avec les regex"><meta property="og:image" content="https://www.gravatar.com/avatar/56f2389bd912f388cc79874ce65fc0dc?s=300"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@atomrc"><meta name="twitter:url" content="https://blog.atomrc.dev/p/regex/"><meta name="twitter:title" content="Regex : tips and tricks - Thomas Belin"><meta name="twitter:description" content="Petites astuces utiles avec les regex"><meta name="twitter:image" content="https://www.gravatar.com/avatar/56f2389bd912f388cc79874ce65fc0dc?s=300"><meta name="theme-color" content="#ffffff"><style>body{--ff-sans:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI","Ubuntu","Roboto","Noto Sans","Droid Sans",sans-serif;--ff-mono:ui-monospace,"Cascadia Mono","Segoe UI Mono","Ubuntu Mono","Roboto Mono",Menlo,Monaco,Consolas,monospace;padding:0;margin:0;color:#333;background-color:#fff;font-family:var(--ff-sans);font-size:13pt}a{text-decoration:none;color:#0e4db5}ul{list-style:none;padding:0}.avatar{height:100px;width:100px;border-radius:50px}.title{color:#e7005d}.tag{font-size:10pt;color:#888;font-style:italic}#header{text-align:center;font-size:1.95em;padding:1em}#header .title{text-shadow:1px 1px 0 #fff;color:inherit;font-weight:200}#footer{background-color:#5986d1;color:#fff;text-align:center;padding:1em}#footer a{color:#010733}</style><script async defer="defer" data-domain="atomrc.dev" src="https://plausible.io/js/plausible.js"></script></head><body><div id="header"><div><a href="/"><img class="avatar" src="https://www.gravatar.com/avatar/56f2389bd912f388cc79874ce65fc0dc?s=200" alt="Avatar"></a><br><a class="title" href="/"><span rel="author">Thomas Belin</span></a><br></div></div><section><link href="/css/article.css" rel="stylesheet" async defer="defer"><link href="/css/syntax.css" rel="stylesheet" async defer="defer"><style>article{max-width:800px;margin:auto;padding:0 1em;position:relative}article h1{font-size:2em;font-weight:300}article h2,article h3{position:relative;padding-bottom:.3em;font-weight:500}article h2{font-size:2em;border-bottom:solid 1px #eee;margin:1em 0 .5em}article h3{font-size:1.5em;margin:1em 2em}article p{line-height:1.6em}article img{border:solid 1px grey;display:block;max-width:90%;margin:auto}</style><article lang="fr"><header><h1 class="title">Regex : tips and tricks</h1><aside><time class="folded-paper" datetime="Fri Sep 05 2014 00:00:00 GMT+0000 (Coordinated Universal Time)" pubdate itemprop="datePublished" content="Fri Sep 05 2014 00:00:00 GMT+0000 (Coordinated Universal Time)">05 <span class="month">Sep</span> 2014</time><br><span class="tag">posts</span>&nbsp; <span class="tag">regex</span>&nbsp;</aside></header><div class="article-body"><p>Allez comme je sais que vous adorez les Expressions Régulières, voila quelques tricks sympas :).<br><strong>Attention, ces techniques ne sont pas disponibles sur tous les moteurs d'expressions régulières</strong>. Pour savoir si les astuces dont je parle dans cet article sont disponibles dans votre langage préféré, je vous invite à consulter ce tableau <a href="http://en.wikipedia.org/wiki/Comparison_of_regular_expression_engines">Comparison of Regular Expression engines</a>.</p><h2 id="la-r%C3%A9p%C3%A9tition-%22ungreedy%22">la répétition &quot;ungreedy&quot;</h2><p>Par défault la répétition va essayer de matcher le plus de caractères possibles. Par exemple (en JavaScript) :</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&lt;.*></span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span><br>    str <span class="token operator">=</span> <span class="token string">"a piece of html: &lt;html>&lt;head>&lt;/head>&lt;/html>"</span><span class="token punctuation">;</span><br><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token comment">//print : "&lt;html>&lt;head>&lt;/head>&lt;/html>"</span></code></pre><p>Mais souvent vous voulez limiter la portée de votre répétition pour ne matcher que <strong>la plus petite chaine</strong>. Dans ce cas là, on va utiliser la répétition &quot;ungreedy&quot; en utilisant le symbole <code>?</code> après la répétition. Ce qui nous donne donc :</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&lt;.*?></span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span><br>    str <span class="token operator">=</span> <span class="token string">"a piece of html: &lt;html>&lt;head>&lt;/head>&lt;/html>"</span><span class="token punctuation">;</span><br><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token comment">//print : "&lt;html>"</span></code></pre><p>Une autre solution pour arriver à ce résultat serait :</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&lt;[^>]*></span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span></code></pre><p>Moins sexy tout de même :)</p><p>Vous pouvez utiliser cette astuce avec tous les types de répétitions (le <code>*</code>, le <code>+</code>, les <code>{.,.}</code> et le <code>?</code>).</p><h2 id="le-lookahead">le lookahead</h2><p>Parfois, avez besoin de faire des vérifications dans votre chaine de caractères, sans pour autant vous déplacer dedans.<br>Exemple typique, vérifier que différentes conditions sont présentes dans la chaine, sans savoir dans quel ordre elles seront.<br>Admettons que vous voulez trouver toutes les phrases ou apparaissent à la fois <code>Felix</code> et <code>stratosphere</code> dans la chaîne suivante :</p><pre><code>I heard Felix is going to jump from the stratosphere.  
I know he's going to do it.  
Felix is the best.  
The stratosphere isn't far enough for Felix.
</code></pre><p>On va alors utiliser un lookahead pour vérifier que les mots <code>Felix</code> et <code>stratosphere</code> sont présents dans la chaine sans faire attention à leur position. Pour cela il serait idéal <strong>de lire la chaine mais sans ce déplacer dedans</strong> ! C'est justement le but du lookahead qui permet de simplement regarder sans faire avancer le pointeur de lecture de votre regex.</p><p>L'idée est donc d'aller regarder si <code>stratosphere</code> est dans la chaine, puis si <code>Felix</code> est dans cette même chaine (en partant toujours du début) et si ces deux conditions sont réunies alors commencer le matching.</p><p>Le lookahead (positif) s'écrit <code>(?=regex)</code> (il existe également le lookup négatif qui cherche quelque chose qui ne doit pas exister qui s'écrit <code>(?!regex)</code>)</p><p>Voila la solution au problème précédent (toujours en JavaScript :)) :</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?=.*stratosphere)(?=.*Felix).*?\.</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span><br>    str <span class="token operator">=</span> <span class="token string">"I heard Felix is going to jump from the stratosphere.\n I know he's going to do it.\n Felix is the best.\n The stratosphere isn't far enough for Felix."</span><span class="token punctuation">;</span><br><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//[ "I heard Felix is going to jump from the stratosphere.", " The stratosphere isn't far enough for Felix." ]</span></code></pre><p>Une solution possible sans utiliser les lookahead serait :</p><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.*(Felix.*stratosphere|stratosphere.*Felix).*</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span></code></pre><p>Vous saisissez l'idée : on vérifie que on trouve :</p><ul><li>soit <code>Felix</code> puis <code>stratosphere</code> ;</li><li>soit <code>stratosphere</code> puis <code>Felix</code>.</li></ul><p>Encore une fois, un petit manque de sexy :)</p><p>Un bon use case de cette technique serait par exemple de <strong>vérifier qu'un password dispose d'au moins une majuscule et d'un digit</strong>. (Je vous laisse ça en exercice ;))</p><p>Voila n'hésitez pas à laisser d'autres techniques pratiques que vous utilisez avec nos chères amies les <code>regex</code>.</p></div><br><em>You enjoyed this article? Consider <a target="_blank" rel="noopener noreferrer" href="https://twitter.com/intent/tweet?url=https://blog.atomrc.dev/p/regex/&text=Regex : tips and tricks&via=atomrc">tweeting it</a> :)</em></article><script src="/js/application.js" async></script><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "WebSite",
      "@id": "https://blog.atomrc.dev#website",
      "url": "https://blog.atomrc.dev",
      "name": "Thomas Belin",
      "description": "Senior Front-End Architect @deezer in Paris. I leave code cleaner than I found it. Seriously into Functional and Reactive Programming.",
      "inLanguage": "fr"
    },
    {
      "@type": "BlogPosting",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://blog.atomrc.dev/p/regex/"
      },
      "url": "https://blog.atomrc.dev/p/regex/",
      "isPartOf": {
        "@id": "https://blog.atomrc.dev#website"
      },
      "headline": "Regex : tips and tricks",
      "description": "Petites astuces utiles avec les regex",
      "image": "https://www.gravatar.com/avatar/56f2389bd912f388cc79874ce65fc0dc?s=300",
      "inLanguage": "fr",
      "publisher": {
        "@type": "Organization",
        "name": "Thomas Belin",
        "url": "https://blog.atomrc.dev",
        "logo": {
          "@type": "ImageObject",
          "url": "https://www.gravatar.com/avatar/56f2389bd912f388cc79874ce65fc0dc?s=300",
          "width": 300,
          "height": 300
        }
      },
      "author": {
        "@type": "Person",
        "name": "Thomas Belin"
      },
      "keywords": "posts,regex",
      "datePublished": "2014-09-05T00:00:00.000Z"
    }
  ]
}</script></section><div id="footer"><address>Senior Front-End Engineer <a href="https://deezer.com" target="_blank" rel="noreferrer noopener">@deezer</a> in Paris.<br>I leave code cleaner than I found it.<br>I tweet (<a href="https://twitter.com/atomrc" target="_blank" rel="noreferrer noopener">@atomrc</a>) and I code (<a href="https://github.com/atomrc" target="_blank" rel="noreferrer noopener">atomrc</a>)<br>I help (<a href="https://stackoverflow.com/users/2745879/atomrc" target="_blank" rel="noreferrer noopener">S.O profile</a>)</address></div></body></html>